"use strict";

var fullPlan = [{
  week: 1,
  run: 1,
  plan: [5, 1, 1.5, 1, 1.5, 1, 1.5, 1, 1.5, 1, 1.5, 1, 1.5, 1, 1.5, 1, 5]
}, {
  week: 1,
  run: 2,
  plan: [5, 1, 1.5, 1, 1.5, 1, 1.5, 1, 1.5, 1, 1.5, 1, 1.5, 1, 1.5, 1, 5]
}, {
  week: 1,
  run: 3,
  plan: [5, 1, 1.5, 1, 1.5, 1, 1.5, 1, 1.5, 1, 1.5, 1, 1.5, 1, 1.5, 1, 5]
}, {
  week: 2,
  run: 1,
  plan: [5, 1.5, 2, 1.5, 2, 1.5, 2, 1.5, 2, 1.5, 2, 1.5, 5]
}, {
  week: 2,
  run: 2,
  plan: [5, 1.5, 2, 1.5, 2, 1.5, 2, 1.5, 2, 1.5, 2, 1.5, 5]
}, {
  week: 2,
  run: 3,
  plan: [5, 1.5, 2, 1.5, 2, 1.5, 2, 1.5, 2, 1.5, 2, 1.5, 5]
}, {
  week: 3,
  run: 1,
  plan: [5, 1.5, 1.5, 3, 3, 1.5, 1.5, 3, 5]
}, {
  week: 3,
  run: 2,
  plan: [5, 1.5, 1.5, 3, 3, 1.5, 1.5, 3, 5]
}, {
  week: 3,
  run: 3,
  plan: [5, 1.5, 1.5, 3, 3, 1.5, 1.5, 3, 5]
}, {
  week: 4,
  run: 1,
  plan: [5, 3, 1.5, 5, 2.5, 3, 1.5, 5, 5]
}, {
  week: 4,
  run: 2,
  plan: [5, 3, 1.5, 5, 2.5, 3, 1.5, 5, 5]
}, {
  week: 4,
  run: 3,
  plan: [5, 3, 1.5, 5, 2.5, 3, 1.5, 5, 5]
}, {
  week: 5,
  run: 1,
  plan: [5, 5, 3, 5, 3, 5, 5]
}, {
  week: 5,
  run: 2,
  plan: [5, 8, 5, 8, 5]
}, {
  week: 5,
  run: 3,
  plan: [5, 20, 5]
}, {
  week: 6,
  run: 1,
  plan: [5, 5, 3, 8, 3, 5, 5]
}, {
  week: 6,
  run: 2,
  plan: [5, 10, 3, 10, 5]
}, {
  week: 6,
  run: 3,
  plan: [5, 25, 5]
}, {
  week: 7,
  run: 1,
  plan: [5, 25, 5]
}, {
  week: 7,
  run: 2,
  plan: [5, 25, 5]
}, {
  week: 7,
  run: 3,
  plan: [5, 25, 5]
}, {
  week: 8,
  run: 1,
  plan: [5, 28, 5]
}, {
  week: 8,
  run: 2,
  plan: [5, 28, 5]
}, {
  week: 8,
  run: 3,
  plan: [5, 28, 5]
}, {
  week: 9,
  run: 1,
  plan: [5, 30, 5]
}, {
  week: 9,
  run: 2,
  plan: [5, 30, 5]
}, {
  week: 9,
  run: 3,
  plan: [5, 30, 5]
}];
"use strict";

var app = new Vue({
  el: '#app',
  data: {
    fullPlan: fullPlan,
    settingsOpen: false,
    editDates: false,
    settings: {
      showDates: true,
      showWarmupCooldown: true
    }
  },
  computed: {
    computedDates: function computedDates() {
      if (!this.fullPlan || !this.fullPlan[0].date) return false;
      var datesArray = [];

      for (var i = 0; i < this.fullPlan.length; i++) {
        var newDate = "";

        if (this.fullPlan[i].date) {
          console.log('pushed 1');
          newDate = this.fullPlan[i].date;
        } else {
          if (this.fullPlan[i - 1].run == 3) {
            console.log('day 3');
            newDate = this.addDays(datesArray[i - 1], 3);
          } else {
            newDate = this.addDays(datesArray[i - 1], 2);
          }
        }

        datesArray.push(newDate);
      }

      return datesArray;
    }
  },
  methods: {
    addDays: function addDays(prevDate, daysToAdd) {
      console.log('prevDate: ', prevDate);
      console.log('daysToAdd: ', daysToAdd);
      var newDate = new Date(prevDate);
      newDate.setDate(newDate.getDate() + daysToAdd);
      newDate.toISOString().substring(0, 10);
      return newDate.toISOString().substring(0, 10);
    },
    formatDate: function formatDate(thisDate) {
      if (!thisDate) return false;
      var dateArray = thisDate.split('-');
      return dateArray[2] + "/" + dateArray[1] + "/" + dateArray[0].slice(2, 4);
    },
    toggleSettings: function toggleSettings() {
      this.settingsOpen = !this.settingsOpen;
    },
    storeData: function storeData() {
      var saveData = JSON.stringify({
        theFullPlan: this.fullPlan,
        theSettings: this.settings
      });
      localStorage.setItem('jamie_c25k', saveData);
      console.log('saved!');
    },
    getData: function getData() {
      var loadData = JSON.parse(localStorage.getItem('jamie_c25k'));
      console.log('loadData: ', loadData);

      if (loadData) {
        this.fullPlan = loadData.theFullPlan;
        this.settings = loadData.theSettings;
      }
    },
    removeData: function removeData() {
      localStorage.removeItem('jamie_c25k');
    }
  },
  watch: {
    fullPlan: {
      deep: true,
      handler: function handler() {
        this.storeData();
      }
    },
    settings: {
      deep: true,
      handler: function handler() {
        this.storeData();
      }
    }
  },
  mounted: function mounted() {
    this.getData();
  }
});